{{ define "main" }}
<div class="project-container">
    <div class="project-header">
        <h1>{{ .Title }}</h1>
        {{ if .Params.description }}
        <p class="project-description">{{ .Params.description }}</p>
        {{ end }}
    </div>
    
    <div class="project-images">
        {{ if .Params.image }}
        <div class="project-main-image">
            {{ $image := .Resources.GetMatch .Params.image }}
            {{ if $image }}
            <div class="image-container">
                {{ if eq $image.MediaType.SubType "svg" }}
                <img src="{{ $image.RelPermalink }}" alt="{{ .Title }}" class="clickable-image"
                    data-full-res="{{ $image.RelPermalink }}" loading="lazy">
                {{ else }}
                {{ $resized := $image.Resize "1200x1200 webp q85" }}
                <img src="{{ $resized.RelPermalink }}" alt="{{ .Title }}" class="clickable-image"
                    data-full-res="{{ $image.RelPermalink }}" loading="lazy">
                {{ end }}
                <div class="image-overlay">
                    <span class="zoom-icon">üîç</span>
                    <span class="zoom-text">Click to view full resolution</span>
                </div>
            </div>
            {{ else }}
            <div class="image-container">
                <img src="{{ .Params.image }}" alt="{{ .Title }}" class="clickable-image" data-full-res="{{ .Params.image }}"
                    loading="lazy">
                <div class="image-overlay">
                    <span class="zoom-icon">üîç</span>
                    <span class="zoom-text">Click to view full resolution</span>
                </div>
            </div>
            {{ end }}
        </div>
        {{ end }}
        
        {{ if .Params.additional_images }}
        <div class="project-gallery">
            {{ range .Params.additional_images }}
            <div class="gallery-item">
                {{ $additionalImage := $.Resources.GetMatch . }}
                {{ if $additionalImage }}
                <div class="image-container">
                    {{ if eq $additionalImage.MediaType.SubType "svg" }}
                    <img src="{{ $additionalImage.RelPermalink }}" alt="{{ $.Title }}" class="clickable-image"
                        data-full-res="{{ $additionalImage.RelPermalink }}" loading="lazy">
                    {{ else }}
                    {{ $resized := $additionalImage.Resize "800x800 webp q80" }}
                    <img src="{{ $resized.RelPermalink }}" alt="{{ $.Title }}" class="clickable-image"
                        data-full-res="{{ $additionalImage.RelPermalink }}" loading="lazy">
                    {{ end }}
                    <div class="image-overlay">
                        <span class="zoom-icon">üîç</span>
                    </div>
                </div>
                {{ else }}
                <div class="image-container">
                    <img src="{{ . }}" alt="{{ $.Title }}" class="clickable-image" data-full-res="{{ . }}" loading="lazy">
                    <div class="image-overlay">
                        <span class="zoom-icon">üîç</span>
                    </div>
                </div>
                {{ end }}
            </div>
            {{ end }}
        </div>
        {{ end }}
    </div>
    
    <div class="project-content">
        {{ .Content }}
    </div>
    
    <div class="project-navigation">
        <a href="{{ .Parent.RelPermalink }}" class="back-link">‚Üê Back to {{ .Parent.Title }}</a>
    </div>
</div>
<!-- Full Resolution Image Modal -->
<div id="imageModal" class="image-modal">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <img id="modalImage" src="" alt="Full resolution image">
        <div class="modal-caption"></div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const modal = document.getElementById('imageModal');
        const modalImg = document.getElementById('modalImage');
        const modalCaption = document.querySelector('.modal-caption');
        const closeBtn = document.querySelector('.close-modal');
        const clickableImages = document.querySelectorAll('.clickable-image');

        // Open modal when image is clicked
        clickableImages.forEach((img, index) => {
            img.addEventListener('click', function () {
                modal.style.display = 'block';
                modalImg.src = this.getAttribute('data-full-res');
                modalCaption.textContent = this.alt;
            });
        });

        // Close modal when clicking the close button
        closeBtn.addEventListener('click', function () {
            modal.style.display = 'none';
        });

        // Close modal when clicking outside the image
        modal.addEventListener('click', function (e) {
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape' && modal.style.display === 'block') {
                modal.style.display = 'none';
            }
        });
    });
</script>
{{ end }}
